<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 연결할 mapper의 interface 풀 경로 작성 -->
<mapper namespace="com.gogo.mapper.mypageMapper">
	<!--  ▶▶▶  admin ▶▶▶ -->
	<!-- 숙소 관리 -->
	<select id="getList" resultType="com.gogo.vo.StayVO">
		select stayNo, stayname, memberId, stayInfo, mainpic1 from stay
	</select>
	
	<!-- 사용자 관리 -->
	<select id="getMember" resultType="com.gogo.vo.MemberVO">
		SELECT memberid, membername, memberemail,
			TO_CHAR(registraiondate, 'YYYY-MM-DD') AS registraiondate
		FROM member
	</select>
	
	<!--  ▶▶▶  host ▶▶▶ -->
	<!-- 숙소 관리 -->
	<select id="getStay" resultType="com.gogo.vo.StayVO">
	<!-- 나중에 where 절 삭제하고 session id 값과 비교  -->
		SELECT stayname, stayloc, stayadress, staytype, mainpic1 FROM stay
		WHERE memberid like 'host%'
	</select>
	
	<!-- 예약 관리 -->
	<select id="reservinfo" resultType="com.gogo.vo.ReservedVO">
	<!-- 회원 아이디와 비교해서 해당 -> 출력 -->
		SELECT
		      roomno,
		      memberid,
		      TO_CHAR(regdate, 'YY-MM-DD') AS regdate,
		      TO_CHAR(checkin, 'YY-MM-DD') AS checkin,
		      TO_CHAR(checkout, 'YY-MM-DD') AS checkout,
		      membercount
	    FROM reservation
	</select>
	
	<!-- 예약 관리 숙소 대표 사진 -->
	<resultMap type="map" id="stayMap">
	    <result property="stayName" column="STAYNAME" />
	    <result property="mainPic1" column="MAINPIC1" />
	    <result property="roomNo" column="ROOMNO" />
	</resultMap>
	
	 <select id="reservpic" resultMap="stayMap">
	    SELECT s.STAYNAME, s.MAINPIC1, r.ROOMNO
	    FROM STAY s
	    JOIN ROOM r ON s.STAYNO = r.STAYNO
	    JOIN RESERVATION v ON r.ROOMNO = v.ROOMNO
	</select>  
	
	<!-- 가이드 문의 요청 -->
	<insert id="insert">
		<selectKey keyProperty="queNo" order="BEFORE" resultType="int">
			select QUESEQ.nextval from dual
		</selectKey>
	
		insert into question (queNo, memberId, title, content, contentDate) 
		values (#{queNo}, #{memberId}, #{title}, #{content}, sysdate)
	</insert>

	<!-- 문의 list 출력 -->
	<select id="qaList" resultType="com.gogo.vo.QuestionVO">
	<!-- 회원 아이디와 비교해서 해당 -> 출력 -->
		select queno, title, content, to_char(contentdate, 'yy-dd-mm') as contentdate from question
	</select>

	<!-- 문의 한건 출력 -->
	<select id="getOne" resultType="com.gogo.vo.QuestionVO">
	<!-- 회원 아이디와 비교해서 해당 -> 출력 -->
		select queNo, title, content from question where queNo = #{queNo}
	</select>
	
	
	<!--  ▶▶▶  host ▶▶▶ -->
	<!-- 숙소 관리 -->
	<select id="mem" resultType="com.gogo.vo.MemberVO">
		select memberid, membername, pw, memberemail from member
	</select>


</mapper>